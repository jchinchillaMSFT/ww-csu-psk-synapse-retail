{
	"name": "DimGeography_DF",
	"properties": {
		"folder": {
			"name": "adworkstarget"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"name": "LocationSource"
				}
			],
			"sinks": [
				{
					"name": "DimGeography"
				}
			],
			"transformations": [
				{
					"name": "surrogateKey"
				},
				{
					"name": "aggregate1"
				}
			],
			"scriptLines": [
				"source(output(",
				"          LocationId as short,",
				"          LocationZip as short,",
				"          LocationState as string,",
				"          LocationCity as string,",
				"          Country as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     store: 'synapse',",
				"     databaseType: 'spark',",
				"     format: 'table',",
				"     database: 'adworks',",
				"     tableName: 'Location') ~> LocationSource",
				"aggregate1 keyGenerate(output(LocationKey as long),",
				"     startAt: 1L,",
				"     stepValue: 1L) ~> surrogateKey",
				"LocationSource aggregate(groupBy(LocationId),",
				"     LocationZip = last(LocationZip),",
				"          LocationState = last(LocationState),",
				"          LocationCity = last(LocationCity),",
				"          Country = last(Country)) ~> aggregate1",
				"surrogateKey sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     store: 'synapse',",
				"     databaseType: 'spark',",
				"     format: 'table',",
				"     database: 'adworkstarget',",
				"     tableName: 'DimGeography',",
				"     recreate:true) ~> DimGeography"
			]
		}
	}
}