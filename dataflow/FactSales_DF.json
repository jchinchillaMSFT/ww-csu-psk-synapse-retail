{
	"name": "FactSales_DF",
	"properties": {
		"folder": {
			"name": "adworkstarget"
		},
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"name": "SalesSource"
				},
				{
					"name": "DimCustomerSource"
				},
				{
					"name": "DimResellerSource"
				},
				{
					"name": "DimChannelSource"
				}
			],
			"sinks": [
				{
					"name": "FactSalesSink"
				}
			],
			"transformations": [
				{
					"name": "Sales"
				},
				{
					"name": "CustomerData"
				},
				{
					"name": "JoinCustomerData"
				},
				{
					"name": "Reseller"
				},
				{
					"name": "JoinReseller"
				},
				{
					"name": "SelectJoinReseller"
				},
				{
					"name": "aggregate1"
				},
				{
					"name": "JoinChannelType"
				},
				{
					"name": "derivedColumn1"
				}
			],
			"script": "parameters{\n\tmodifiedAfter as timestamp (toTimestamp(\"01-01-1900\")),\n\tmodifiedBefore as timestamp (currentTimestamp())\n}\nsource(output(\n\t\tSalesAmount as double,\n\t\tTotalProductCost as double,\n\t\tProductStandardCost as double,\n\t\tUnitPriceDiscountPct as boolean,\n\t\tExtendedAmount as double,\n\t\tUnitPrice as double,\n\t\tOrderQuantity as short,\n\t\tSalesTerritoryId as short,\n\t\tOrderDate as date,\n\t\tProductId as short,\n\t\tSalesOrderLineId as integer,\n\t\tChannel as string,\n\t\tSalesOrder as string,\n\t\tCustomerId as string,\n\t\tResellerId as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'adworks',\n\ttableName: 'Sales',\n\tmanifestType: 'manifest') ~> SalesSource\nsource(output(\n\t\tCustomerKey as integer,\n\t\tCustomerId as string,\n\t\tCustomer as string,\n\t\tCity as string,\n\t\tStateProvince as string,\n\t\tCountryRegion as string,\n\t\tPostalCode as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'adworks',\n\ttableName: 'CustomerData',\n\tmanifestType: 'manifest') ~> DimCustomerSource\nsource(output(\n\t\tPostalCode as string,\n\t\tCountryRegion as string,\n\t\tStateProvince as string,\n\t\tCity as string,\n\t\tReseller as string,\n\t\tBusinessType as string,\n\t\tResellerId as string,\n\t\tResellerKey as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'adworks',\n\ttableName: 'Reseller',\n\tmanifestType: 'manifest') ~> DimResellerSource\nsource(output(\n\t\tChannelTypeId as short,\n\t\tChannelTypeName as string,\n\t\tChannelTypeKey as long\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tlimit: 100,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'adworkstarget',\n\ttableName: 'ChannelType') ~> DimChannelSource\nderivedColumn1 select(mapColumn(\n\t\tSalesAmount,\n\t\tTotalProductCost,\n\t\tProductStandardCost,\n\t\tUnitPriceDiscountPct,\n\t\tExtendedAmount,\n\t\tUnitPrice,\n\t\tOrderQuantity,\n\t\tSalesTerritoryKey,\n\t\tShipDateKey,\n\t\tDueDateKey,\n\t\tOrderDateKey,\n\t\tProductKey,\n\t\tCustomerKey,\n\t\tResellerKey,\n\t\tSalesOrderLineKey\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> Sales\nDimCustomerSource select(mapColumn(\n\t\tCustomerId\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> CustomerData\nSales join(Sales@CustomerKey == CustomerData@CustomerKey,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinCustomerData\nDimResellerSource select(mapColumn(\n\t\tResellerId\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> Reseller\nJoinCustomerData, Reseller join(Sales@ResellerKey == Reseller@ResellerKey,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinReseller\nJoinChannelType select(mapColumn(\n\t\tSalesOrder,\n\t\tSalesAmount,\n\t\tCustomerKey = CustomerData@CustomerKey,\n\t\tResellerKey = Sales@ResellerKey,\n\t\tChannelTypeKey\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> SelectJoinReseller\nSelectJoinReseller aggregate(groupBy(SalesOrder,\n\t\tChannelTypeKey,\n\t\tCustomerKey,\n\t\tResellerKey),\n\tSalesAmount = sum(SalesAmount)) ~> aggregate1\nJoinReseller, DimChannelSource join(Channel == ChannelTypeName,\n\tjoinType:'left',\n\tbroadcast: 'auto')~> JoinChannelType\nSalesSource derive(CustomerId = iifNull(CustomerId,'N/A'),\n\t\tResellerId = iifNull(ResellerId,'N/A'),\n\t\tProductId = iifNull(ProductId,-1),\n\t\tSalesTerritoryId = iifNull(SalesTerritoryId,-1)) ~> derivedColumn1\naggregate1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tstore: 'synapse',\n\tdatabaseType: 'spark',\n\tformat: 'table',\n\tdatabase: 'adworkstarget',\n\ttableName: 'FactSales',\n\trecreate:true,\n\tmanifestType: 'manifest') ~> FactSalesSink"
		}
	}
}